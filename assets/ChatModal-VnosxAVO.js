import{h as l,m as p,q as g,j as e}from"./index-VfP6m85b.js";import{B as j}from"./bike-C2pB_j3D.js";import{U as y}from"./user-CkJPpAez.js";import{X as v}from"./x-CjeeDpu0.js";import{S as N}from"./send-7p_JSYif.js";const $=({orderId:d,isOpen:n,onClose:o,recipientName:u,recipientRole:x})=>{const[r,c]=l.useState(""),{chats:b,sendMessage:f}=p(),{user:s}=g(),m=l.useRef(null),a=b.filter(t=>t.orderId===d);if(l.useEffect(()=>{var t;n&&((t=m.current)==null||t.scrollIntoView({behavior:"smooth"}))},[a,n]),!n||!s)return null;const h=t=>{t.preventDefault(),r.trim()&&(f({orderId:d,senderId:s.id,senderName:s.name,role:s.role==="rider"?"rider":"user",text:r}),c(""))};return e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center p-0 sm:p-4 pointer-events-none",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm pointer-events-auto",onClick:o}),e.jsxs("div",{className:"bg-white w-full sm:max-w-md h-[80vh] sm:h-[600px] rounded-t-2xl sm:rounded-2xl shadow-2xl flex flex-col relative pointer-events-auto animate-in slide-in-from-bottom-10",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50 rounded-t-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${x==="rider"?"bg-brand-100 text-brand-600":"bg-blue-100 text-blue-600"}`,children:x==="rider"?e.jsx(j,{size:20}):e.jsx(y,{size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:u}),e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Online"})]})]}),e.jsx("button",{onClick:o,className:"p-2 hover:bg-gray-200 rounded-full text-gray-500 transition-colors",children:e.jsx(v,{size:20})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:[a.length===0?e.jsx("p",{className:"text-center text-gray-400 text-sm py-8",children:"Start the conversation..."}):a.map(t=>{const i=t.senderId===s.id;return e.jsx("div",{className:`flex ${i?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[80%] rounded-2xl p-3 text-sm shadow-sm ${i?"bg-brand-500 text-white rounded-br-none":"bg-white text-gray-800 border border-gray-200 rounded-bl-none"}`,children:[e.jsx("p",{children:t.text}),e.jsx("span",{className:`text-[10px] block text-right mt-1 ${i?"text-brand-100":"text-gray-400"}`,children:t.timestamp})]})},t.id)}),e.jsx("div",{ref:m})]}),e.jsxs("form",{onSubmit:h,className:"p-3 border-t border-gray-200 bg-white rounded-b-2xl flex gap-2",children:[e.jsx("input",{value:r,onChange:t=>c(t.target.value),placeholder:"Type a message...",className:"flex-1 bg-gray-100 rounded-full px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-brand-500 transition-all"}),e.jsx("button",{type:"submit",disabled:!r.trim(),className:"w-11 h-11 bg-brand-500 text-white rounded-full flex items-center justify-center hover:bg-brand-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(N,{size:18})})]})]})]})};export{$ as C};
